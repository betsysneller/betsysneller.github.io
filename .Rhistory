inddats %>%
group_by(Exp, AgeCat, Gender, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Gender, Lang.Betsy, value, sd, prop, se) -> propdats
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
ggplot(subset(propdats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
head(inputlinds)
head(inddats)
summary(propdats$AgeCat)
rm(list = ls())
library(dplyr)
library(tidyr)
library(ggplot2)
library(tidyverse)
library(readxl)
library(memisc)
options(dplyr.width = Inf)
p111dat <- read_excel("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P111-phonvar-100-gram/P111data.xlsx")
p311dat <- read_excel("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P311-phonvar-6733-gram/P311data.xlsx")
p211dat <- read.csv("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P211-phonvar-6733-unc/P211Datasheet.csv", head=T)
p121dat <- read.csv("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P121-phonvar-100-soc/P121data.csv", head=T)
p221dat <- read.csv("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P221-phonvar-6733-socunc/P221data.csv", head=T)
p321dat <- read.csv("~/Dropbox/bsneller-current/PhonVarAcquisition/designexp/P321-phonvar-6733-socgram/P321data.csv", head=T)
alldat <- rbind(p111dat, p211dat, p311dat)
alldats <- rbind(p121dat, p221dat, p321dat)
alldat %>%
filter(`RecEx.Betsy` == "no", Lang=="A", Production!="b", Production!="g",
Production!="k", Production!="d", Production!="th", Production!="t", Production!="s",
Production!="", Production!="?", !is.na(Production)) %>%
mutate(Prod = memisc::recode(Production, "p" -> 0, "f" -> 1),
SID = as.factor(SID),
Exp=as.factor(Exp),
AgeCat=as.factor(AgeCat)) %>%
dplyr::select(Exp, SID, AgeCat, Production, Number, Lang.Betsy) -> l
l %>%
group_by(AgeCat, SID, Exp, Number, Lang.Betsy) %>%
summarise(n = n(),
f = sum(Production=="f")/n,
p = sum(Production=="p")/n) %>%
gather(., key="value", value="mean", f,p) %>%
ungroup  %>%
mutate(Number = memisc::recode(.$Number, "sg" -> "Singular", "pl" -> "Plural"),
prop=mean*100) -> inddat
inddat %>%
group_by(Exp, AgeCat, Number, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Number, Lang.Betsy, value, sd, prop, se) -> propdat
inputlprop <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Number = rep(c("Plural","Singular"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlind <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Number = rep(c("Plural","Singular"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdat <- rbind(as.data.frame(propdat), inputlprop)
propdat$Number <- factor(propdat$Number, levels = c("Singular", "Plural"))
propdat$AgeCat <- factor(propdat$AgeCat, levels=c("Input", "C", "M", "A"))
inddat <- rbind(as.data.frame(inddat), inputlind)
inddat$Number <- factor(inddat$Number, levels = c("Singular", "Plural"))
inddat$AgeCat <- factor(inddat$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Grammaticaldat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdat$Exp)){
plot <- ggplot(subset(propdat, Exp==exp & value=="f"), aes(y=prop, x=Number)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddat, Exp==exp & value=="f"), aes(y=prop, x=Number, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
alldats %>%
filter(`RecEx.Betsy` == "no", Lang=="A", Production!="b", Production!="g",
Production!="k", Production!="d", Production!="th", Production!="t", Production!="s",
Production!="", Production!="?", !is.na(Production)) %>%
mutate(Prod = memisc::recode(Production, "p" -> 0, "f" -> 1),
SID = as.factor(SID),
Exp=as.factor(Exp),
AgeCat=as.factor(AgeCat)) %>%
dplyr::select(Exp, SID, AgeCat, Production, Gender, Lang.Betsy) -> s
s %>%
group_by(AgeCat, SID, Exp, Gender, Lang.Betsy) %>%
summarise(n = n(),
f = sum(Production=="f")/n,
p = sum(Production=="p")/n) %>%
gather(., key="value", value="mean", f,p) %>%
ungroup  %>%
mutate(Gender = memisc::recode(.$Gender, "b" -> "Boy", "g" -> "Girl"),
prop=mean*100) -> inddats
inddats %>%
group_by(Exp, AgeCat, Gender, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Gender, Lang.Betsy, value, sd, prop, se) -> propdats
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P111", 4),
rep("P211", 4),
rep("P311", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
summary(inddats)
inddats %>%
group_by(Exp, AgeCat, Gender, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Gender, Lang.Betsy, value, sd, prop, se) -> propdats
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp=="P121" & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
alldats %>%
filter(`RecEx.Betsy` == "no", Lang=="A", Production!="b", Production!="g",
Production!="k", Production!="d", Production!="th", Production!="t", Production!="s",
Production!="", Production!="?", !is.na(Production)) %>%
mutate(Prod = memisc::recode(Production, "p" -> 0, "f" -> 1),
SID = as.factor(SID),
Exp=as.factor(Exp),
AgeCat=as.factor(AgeCat)) %>%
dplyr::select(Exp, SID, AgeCat, Production, Gender, Lang.Betsy) -> s
s %>%
group_by(AgeCat, SID, Exp, Gender, Lang.Betsy) %>%
summarise(n = n(),
f = sum(Production=="f")/n,
p = sum(Production=="p")/n) %>%
gather(., key="value", value="mean", f,p) %>%
ungroup  %>%
mutate(Gender = memisc::recode(.$Gender, "b" -> "Boy", "g" -> "Girl"),
prop=mean*100) -> inddats
inddats %>%
group_by(Exp, AgeCat, Gender, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Gender, Lang.Betsy, value, sd, prop, se) -> propdats
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("bilingual", "immersion", "input", "monolingual"),
limits=c("bilingual", "immersion", "input", "monolingual"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("bilingual", "immersion", "input", "mono"),
limits=c("bilingual", "immersion", "input", "mono"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("biling", "immersion", "input", "mono"),
limits=c("biling", "immersion", "input", "mono"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("biling", "immersion", "input", "mono"),
limits=c("biling", "immersion", "input", "mono"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f" & value!="p"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("biling", "immersion", "input", "mono"),
limits=c("biling", "immersion", "input", "mono"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
alldats %>%
filter(`RecEx.Betsy` == "no", Lang=="A", Production!="b", Production!="g",
Production!="k", Production!="d", Production!="th", Production!="t", Production!="s",
Production!="", Production!="?", !is.na(Production)) %>%
mutate(Prod = memisc::recode(Production, "p" -> 0, "f" -> 1),
SID = as.factor(SID),
Exp=as.factor(Exp),
AgeCat=as.factor(AgeCat)) %>%
dplyr::select(Exp, SID, AgeCat, Production, Gender, Lang.Betsy) -> s
s %>%
group_by(AgeCat, SID, Exp, Gender, Lang.Betsy) %>%
summarise(n = n(),
f = sum(Production=="f")/n,
p = sum(Production=="p")/n) %>%
gather(., key="value", value="mean", f,p) %>%
ungroup  %>%
mutate(Gender = memisc::recode(.$Gender, "b" -> "Boy", "g" -> "Girl"),
prop=mean*100) -> inddats
inddats %>%
group_by(Exp, AgeCat, Gender, value) %>%
mutate(ExpID = paste(Exp, SID),
partn = as.numeric(length(unique(ExpID))),
sd = sd(mean),
prop = mean(mean)*100,
se = (sd/sqrt(partn))*100) %>%
dplyr::select(AgeCat, SID, Exp, Gender, Lang.Betsy, value, sd, prop, se) -> propdats
inputlprops <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
value = rep(c("f","f", "p","p"),3),
sd = rep(0, 12),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67),
se = rep(0, 12))
inputlinds <- data.frame(AgeCat = rep("Input", 12),
SID = rep("Input", 12),
Exp = c(rep("P121", 4),
rep("P221", 4),
rep("P321", 4)),
Gender = rep(c("Girl","Boy"), 6),
Lang.Betsy = rep("Input", 12),
n = rep(1, 12),
value = rep(c("f","f", "p","p"),3),
mean = c(1, 0, 0, 1, .67, .67, .33, .33, .67, .33, .33, .67),
prop = c(100, 0, 0, 100, 67, 67, 33, 33, 67, 33, 33, 67))
propdats <- rbind(as.data.frame(propdats), inputlprops)
propdats$Gender <- factor(propdats$Gender, levels = c("Boy", "Girl"))
propdats$AgeCat <- factor(propdats$AgeCat, levels=c("Input", "C", "M", "A"))
inddats <- rbind(as.data.frame(inddats), inputlinds)
inddats$Gender <- factor(inddats$Gender, levels = c("Boy", "Girl"))
inddats$AgeCat <- factor(inddats$AgeCat, levels=c("Input", "C", "M", "A"))
pdf("~/Box Sync/Publications/2019/AcVar/Socialdat.pdf", onefile=TRUE, height=5, width=20)
for(exp in levels(propdats$Exp)){
plot <- ggplot(subset(propdats, Exp==exp & value=="f" & value!="p"), aes(y=prop, x=Gender)) +
facet_grid(~AgeCat) +
geom_dotplot(data=subset(inddats, Exp==exp & value=="f"), aes(y=prop, x=Gender, fill=Lang.Betsy), binaxis="y",
dotsize=3, binwidth = 1.5, stackgroups=TRUE, binpositions="all", stackdir="centerwhole") +
geom_errorbar(aes(ymin=prop-se, ymax=prop+se), color="black", width=.3, position=position_dodge(.7), size=1) +
theme_bw() +
labs(x="", y="Percent /f/ produced", title=exp) +
scale_fill_manual(breaks=c("biling", "immersion", "Input", "mono"),
limits=c("biling", "immersion", "Input", "mono"),
values=c("#f08854", "#47a186", "#d94579", "#5f4691"))
print(plot)
}
dev.off()
